# Logging para depuración de seguridad
logging.level.org.springframework.security=DEBUG
# --- Logging Detallado para Depuración ---
# Permite ver las consultas SQL generadas por Spring Data JDBC
logging.level.org.springframework.jdbc=DEBUG
logging.level.org.springframework.data.jdbc=DEBUG
# Permite ver el funcionamiento interno del enrutamiento por AOP
logging.level.org.springframework.aop.framework.CglibAopProxy=TRACE
# Activa el informe de depuracion para la autoconfiguracion de Spring Boot
debug=false

# ===================================================================
# CONFIGURACIÓN DE DATA SOURCES - MODO DISCO (PERSISTENTE) Y SIN PASSWORD
# ===================================================================
# Lista de identificadores de bases de datos, separados por comas.
spring.datasource.names=DE,GB,ES,IT,FR,IE,GR,ZA

# --- Configuración para Alemania (DE) ---
spring.datasource.DE.url=jdbc:h2:file:./h2_dbs/db_de
spring.datasource.DE.username=sa
spring.datasource.DE.password=
spring.datasource.DE.driver-class-name=org.h2.Driver

# --- Configuración para Gran Bretaña (GB) ---
spring.datasource.GB.url=jdbc:h2:file:./h2_dbs/db_gb
spring.datasource.GB.username=sa
spring.datasource.GB.password=
spring.datasource.GB.driver-class-name=org.h2.Driver

# --- Configuración para España (ES) ---
spring.datasource.ES.url=jdbc:h2:file:./h2_dbs/db_es
spring.datasource.ES.username=sa
spring.datasource.ES.password=
spring.datasource.ES.driver-class-name=org.h2.Driver

# --- Configuración para Italia (IT) ---
spring.datasource.IT.url=jdbc:h2:file:./h2_dbs/db_it
spring.datasource.IT.username=sa
spring.datasource.IT.password=
spring.datasource.IT.driver-class-name=org.h2.Driver

# --- Configuración para Francia (FR) ---
spring.datasource.FR.url=jdbc:h2:file:./h2_dbs/db_fr
spring.datasource.FR.username=sa
spring.datasource.FR.password=
spring.datasource.FR.driver-class-name=org.h2.Driver

# --- Configuración para Irlanda (IE) ---
spring.datasource.IE.url=jdbc:h2:file:./h2_dbs/db_ie
spring.datasource.IE.username=sa
spring.datasource.IE.password=
spring.datasource.IE.driver-class-name=org.h2.Driver

# --- Configuración para Grecia (GR) ---
spring.datasource.GR.url=jdbc:h2:file:./h2_dbs/db_gr
spring.datasource.GR.username=sa
spring.datasource.GR.password=
spring.datasource.GR.driver-class-name=org.h2.Driver

# --- Configuración para Sudáfrica (ZA) ---
spring.datasource.ZA.url=jdbc:h2:file:./h2_dbs/db_za
spring.datasource.ZA.username=sa
spring.datasource.ZA.password=
# Habilita la consola H2 para depuración (solo en desarrollo)
spring.h2.console.enabled=true 
spring.datasource.ZA.driver-class-name=org.h2.Driver


# ===================================================================
# INICIO DE LA SECCIÓN AÑADIDA PARA MICROSOFT ENTRA ID (PARA ENTORNO LOCAL)
# ===================================================================

# Configuración de Microsoft Entra ID (anteriormente Azure Active Directory)
spring.cloud.azure.active-directory.enabled=true
# Las siguientes propiedades ahora se cargan desde local.env a través de system properties.
# Asegúrate de que las propiedades 'entra.id.tenant-id', 'entra.id.client-id', etc.
# estén definidas en tu local.env para que esto funcione.
spring.cloud.azure.active-directory.tenant-id=${entra.id.tenant-id}
spring.cloud.azure.active-directory.client-id=${entra.id.client-id}
spring.cloud.azure.active-directory.client-secret=${entra.id.client-secret}
spring.cloud.azure.active-directory.redirect-uri-template=${entra.id.redirect-uri}
spring.cloud.azure.active-directory.scopes=${entra.id.scopes}

# Credenciales de la aplicación para el cliente de Azure (referencia a las propiedades definidas arriba)
spring.cloud.azure.active-directory.credential.client-id=${spring.cloud.azure.active-directory.client-id}
spring.cloud.azure.active-directory.credential.client-secret=${spring.cloud.azure.active-directory.client-secret}

# Perfil de Azure (referencia al tenant-id)
spring.cloud.azure.active-directory.profile.tenant-id=${spring.cloud.azure.active-directory.tenant-id}

# Configuración de Spring Security OAuth2 Client para el proveedor 'azure'
spring.security.oauth2.client.registration.azure.client-id=${spring.cloud.azure.active-directory.client-id}
spring.security.oauth2.client.registration.azure.client-secret=${spring.cloud.azure.active-directory.client-secret}
spring.security.oauth2.client.registration.azure.scope=${spring.cloud.azure.active-directory.scopes}
spring.security.oauth2.client.registration.azure.redirect-uri=${spring.cloud.azure.active-directory.redirect-uri-template}
spring.security.oauth2.client.registration.azure.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.azure.client-name=Microsoft Entra ID

# Configuración del proveedor OAuth2 para Microsoft Entra ID
# Estas URIs son endpoints estándar de Entra ID para el flujo OIDC/OAuth2.
spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/${entra.id.tenant-id}/oauth2/v2.0/authorize
spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/${entra.id.tenant-id}/oauth2/v2.0/token
spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/${entra.id.tenant-id}/discovery/v2.0/keys
spring.security.oauth2.client.provider.azure.user-info-uri=https://graph.microsoft.com/v1.0/me
# El atributo en el token de ID que contiene el nombre de usuario. 'name' es común para Entra ID.
spring.security.oauth2.client.provider.azure.user-name-attribute=name
# URI del emisor del token.
spring.security.oauth2.client.provider.azure.issuer-uri=https://sts.windows.net/${entra.id.tenant-id}/


# ===================================================================
# CONFIGURACIÓN SSL PARA HTTPS EN LOCAL
# ===================================================================
# Habilita SSL
server.ssl.enabled=true
# Ruta al keystore (archivo donde se guarda el certificado y la clave privada)
server.ssl.key-store=classpath:keystore.p12
# Tipo de keystore (puedes usar JKS o PKCS12)
server.ssl.key-store-type=PKCS12
# Contraseña del keystore
server.ssl.key-store-password=kikekaja
# Alias de la clave dentro del keystore
server.ssl.key-alias=springboot
# Contraseña de la clave (si es diferente a la del keystore)
server.ssl.key-password=kikekaja

# ===================================================================
# FIN DE LA SECCIÓN AÑADIDA PARA MICROSOFT ENTRA ID
# ===================================================================
